VERSION 5.00
Object = "{C932BA88-4374-101B-A56C-00AA003668DC}#1.1#0"; "MSMASK32.OCX"
Begin VB.Form FrmCashPayVou 
   BackColor       =   &H00C0FFC0&
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Payment Vouchers ..........."
   ClientHeight    =   7995
   ClientLeft      =   1770
   ClientTop       =   495
   ClientWidth     =   8430
   LinkTopic       =   "Form3"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   7995
   ScaleWidth      =   8430
   Begin VB.Frame Framelst1 
      Height          =   4125
      Left            =   90
      TabIndex        =   29
      Top             =   3420
      Visible         =   0   'False
      Width           =   4365
      Begin VB.ListBox List2 
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   3660
         Left            =   90
         TabIndex        =   31
         Top             =   420
         Width           =   4200
      End
      Begin VB.TextBox Text2 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   50
         MaxLength       =   9
         TabIndex        =   30
         Top             =   120
         Width           =   4200
      End
   End
   Begin VB.Frame FrameLst 
      Height          =   6330
      Left            =   4050
      TabIndex        =   32
      Top             =   1080
      Visible         =   0   'False
      Width           =   4335
      Begin VB.ListBox List1 
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   5685
         Left            =   90
         TabIndex        =   34
         Top             =   450
         Width           =   4155
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   90
         MaxLength       =   9
         TabIndex        =   33
         Top             =   180
         Width           =   4150
      End
   End
   Begin VB.TextBox TxtCrTot 
      Alignment       =   1  'Right Justify
      Appearance      =   0  'Flat
      BackColor       =   &H00C0FFFF&
      BeginProperty DataFormat 
         Type            =   1
         Format          =   "#,##0.00"
         HaveTrueFalseNull=   0
         FirstDayOfWeek  =   0
         FirstWeekOfYear =   0
         LCID            =   1033
         SubFormatType   =   1
      EndProperty
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   6390
      TabIndex        =   45
      Top             =   5400
      Width           =   1545
   End
   Begin VB.CommandButton Command1 
      BackColor       =   &H00008000&
      Caption         =   "New A/c."
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   6623
      Style           =   1  'Graphical
      TabIndex        =   40
      Top             =   7530
      Width           =   1500
   End
   Begin VB.CommandButton CmdDel 
      BackColor       =   &H0000C000&
      Caption         =   "&Delete"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   3240
      Style           =   1  'Graphical
      TabIndex        =   12
      Top             =   5430
      Width           =   1500
   End
   Begin VB.CommandButton CmdEdit 
      BackColor       =   &H00008000&
      Caption         =   "De&lete"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   3443
      Style           =   1  'Graphical
      TabIndex        =   19
      Top             =   7530
      Width           =   1500
   End
   Begin VB.CommandButton CmdEnd 
      BackColor       =   &H0000C000&
      Caption         =   "En&d"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4800
      Style           =   1  'Graphical
      TabIndex        =   13
      Top             =   5430
      Width           =   1500
   End
   Begin VB.CommandButton cmdNext 
      BackColor       =   &H0000C000&
      Caption         =   "Nex&t"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   1680
      Style           =   1  'Graphical
      TabIndex        =   11
      Top             =   5430
      Width           =   1500
   End
   Begin VB.Frame Frame4 
      Height          =   1650
      Left            =   90
      TabIndex        =   35
      Top             =   5850
      Width           =   8250
      Begin VB.TextBox TxtDes 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1140
         Left            =   1260
         MaxLength       =   200
         MultiLine       =   -1  'True
         ScrollBars      =   2  'Vertical
         TabIndex        =   16
         Top             =   360
         Width           =   6555
      End
      Begin VB.TextBox TxtChqNo 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   1740
         MaxLength       =   15
         TabIndex        =   14
         Top             =   1680
         Visible         =   0   'False
         Width           =   2235
      End
      Begin MSMask.MaskEdBox mtchqdt 
         Height          =   300
         Left            =   6420
         TabIndex        =   15
         Top             =   1680
         Visible         =   0   'False
         Width           =   1875
         _ExtentX        =   3307
         _ExtentY        =   529
         _Version        =   393216
         Appearance      =   0
         MaxLength       =   10
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Times New Roman"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Format          =   "dd/MM/yyyy"
         Mask            =   "99/99/9999"
         PromptChar      =   " "
      End
      Begin VB.Label Label6 
         AutoSize        =   -1  'True
         Caption         =   "Description :-"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   120
         TabIndex        =   38
         Top             =   360
         Width           =   1080
      End
      Begin VB.Label Label10 
         AutoSize        =   -1  'True
         Caption         =   "Cheque Date :-"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   4860
         TabIndex        =   37
         Top             =   1725
         Visible         =   0   'False
         Width           =   1200
      End
      Begin VB.Label Label5 
         AutoSize        =   -1  'True
         Caption         =   "Cheque No. :-"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   300
         TabIndex        =   36
         Top             =   1725
         Visible         =   0   'False
         Width           =   1095
      End
   End
   Begin VB.Frame Frame1 
      BackColor       =   &H00E0E0E0&
      Height          =   1020
      Left            =   75
      TabIndex        =   25
      Top             =   2820
      Width           =   8220
      Begin VB.TextBox TxtCAcName 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   4200
         Locked          =   -1  'True
         TabIndex        =   7
         TabStop         =   0   'False
         Top             =   240
         Width           =   3810
      End
      Begin VB.TextBox TxtCAccode 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   2160
         TabIndex        =   6
         Top             =   225
         Width           =   1995
      End
      Begin MSMask.MaskEdBox TxtCrAmt 
         Height          =   330
         Left            =   2160
         TabIndex        =   8
         Top             =   600
         Width           =   1995
         _ExtentX        =   3519
         _ExtentY        =   582
         _Version        =   393216
         Appearance      =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Format          =   "#,##0.00;(#,##0.00)"
         PromptChar      =   " "
      End
      Begin VB.Label Label9 
         AutoSize        =   -1  'True
         BackColor       =   &H00E0E0E0&
         Caption         =   "Debit Amount  :-"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   120
         TabIndex        =   27
         Top             =   720
         Width           =   1320
      End
      Begin VB.Label Label8 
         AutoSize        =   -1  'True
         BackColor       =   &H00E0E0E0&
         Caption         =   "Account Code / Name :-"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   120
         TabIndex        =   26
         Top             =   360
         Width           =   1845
      End
   End
   Begin VB.CommandButton cmdSave 
      BackColor       =   &H00008000&
      Caption         =   "&Save"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   308
      Style           =   1  'Graphical
      TabIndex        =   17
      Top             =   7530
      Width           =   1500
   End
   Begin VB.CommandButton cmdUpdate 
      BackColor       =   &H0000C000&
      Caption         =   "&Update"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   90
      Style           =   1  'Graphical
      TabIndex        =   10
      Top             =   5430
      Width           =   1500
   End
   Begin VB.CommandButton cmdNew 
      BackColor       =   &H00008000&
      Caption         =   "&New Record"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   1868
      Style           =   1  'Graphical
      TabIndex        =   18
      Top             =   7530
      Width           =   1500
   End
   Begin VB.CommandButton cmdExit 
      BackColor       =   &H00008000&
      Caption         =   "E&xit"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   5033
      Style           =   1  'Graphical
      TabIndex        =   20
      Top             =   7530
      Width           =   1500
   End
   Begin VB.Frame Frame2 
      Height          =   1830
      Left            =   75
      TabIndex        =   21
      Top             =   990
      Width           =   3855
      Begin VB.ComboBox months 
         BackColor       =   &H00FFC0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   360
         Left            =   1620
         Style           =   2  'Dropdown List
         TabIndex        =   0
         Top             =   270
         Visible         =   0   'False
         Width           =   1995
      End
      Begin VB.ComboBox YearList 
         BackColor       =   &H00FFC0FF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C000C0&
         Height          =   360
         ItemData        =   "FrmCashPayVou.frx":0000
         Left            =   1620
         List            =   "FrmCashPayVou.frx":002B
         Style           =   2  'Dropdown List
         TabIndex        =   1
         Top             =   270
         Visible         =   0   'False
         Width           =   1005
      End
      Begin VB.TextBox TxtVno 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   1620
         TabIndex        =   2
         Top             =   720
         Width           =   1995
      End
      Begin MSMask.MaskEdBox MtVDt 
         Height          =   330
         Left            =   1620
         TabIndex        =   3
         Top             =   1080
         Width           =   1995
         _ExtentX        =   3519
         _ExtentY        =   582
         _Version        =   393216
         Appearance      =   0
         MaxLength       =   10
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Times New Roman"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Format          =   "dd/MM/yyyy"
         Mask            =   "99/99/9999"
         PromptChar      =   " "
      End
      Begin VB.Label Label11 
         Caption         =   "Year"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   180
         TabIndex        =   43
         Top             =   360
         Visible         =   0   'False
         Width           =   1140
      End
      Begin VB.Label Label2 
         Caption         =   "Month "
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   180
         TabIndex        =   42
         Top             =   360
         Visible         =   0   'False
         Width           =   1140
      End
      Begin VB.Label monthNumber 
         Caption         =   "1"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000C0&
         Height          =   225
         Left            =   3240
         TabIndex        =   41
         Top             =   180
         Visible         =   0   'False
         Width           =   195
      End
      Begin VB.Label LBL 
         AutoSize        =   -1  'True
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   5760
         TabIndex        =   24
         Top             =   240
         Visible         =   0   'False
         Width           =   75
      End
      Begin VB.Label Label7 
         Caption         =   "Voucher Date"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   180
         TabIndex        =   23
         Top             =   1170
         Width           =   1245
      End
      Begin VB.Label Label1 
         Caption         =   "Voucher No."
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   180
         TabIndex        =   22
         Top             =   810
         Width           =   1140
      End
   End
   Begin VB.Data Data1 
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   1560
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   5040
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.Frame Frame3 
      Height          =   1380
      Left            =   4080
      TabIndex        =   39
      Top             =   1020
      Width           =   4245
      Begin VB.TextBox TxtDAcName 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   120
         Locked          =   -1  'True
         TabIndex        =   5
         TabStop         =   0   'False
         Top             =   870
         Width           =   4050
      End
      Begin VB.TextBox txtDAccode 
         Appearance      =   0  'Flat
         DataField       =   "OULCODE"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   2160
         TabIndex        =   4
         Top             =   240
         Width           =   1995
      End
      Begin VB.Label Label3 
         AutoSize        =   -1  'True
         Caption         =   "Account Code / Name :-"
         BeginProperty Font 
            Name            =   "Times New Roman"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   225
         Left            =   120
         TabIndex        =   9
         Top             =   360
         Width           =   1845
      End
   End
   Begin VB.Data Data2 
      Caption         =   "Data2"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   4800
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   "Temp1"
      Top             =   4800
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.Data Data3 
      Caption         =   "Data2"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   5130
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   "Temp"
      Top             =   4410
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.Data Data4 
      Caption         =   "Data2"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   5310
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   "Temp"
      Top             =   4680
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.Label TimeLBL 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H00C0E0FF&
      BackStyle       =   0  'Transparent
      Caption         =   "Cash  Receipt Vouchers"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00008000&
      Height          =   210
      Left            =   0
      TabIndex        =   44
      Top             =   720
      Width           =   8340
   End
   Begin VB.Label UserLBL 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H00C0E0FF&
      BackStyle       =   0  'Transparent
      Caption         =   "Cash  Receipt Vouchers"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   300
      Left            =   0
      TabIndex        =   46
      Top             =   450
      Width           =   8340
   End
   Begin VB.Label Label4 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H00C0FFFF&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Debit Vouchers  (Payment)"
      BeginProperty Font 
         Name            =   "Times New Roman"
         Size            =   15.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   390
      Left            =   90
      TabIndex        =   28
      Top             =   45
      Width           =   8160
   End
End
Attribute VB_Name = "FrmCashPayVou"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim monthno As Integer
Dim yearno As Integer
Private Sub Calcu()
    vvx = str(Val(monthNumber.Caption))
    vvx2 = Left(MtVDt.Text, 2)
    yearno = Val(YearList.Text)
    MtVDt.Text = Format(vvx2 & "/" & vvx & "/" & YearList.Text, "dd/mm/yyyy")
    UserLBL.Caption = ""
    TimeLBL.Caption = ""
End Sub

Private Sub cmddel_Click()

d = DBAct.SelText

Data1.RecordSource = "select * from Temp where Actcode = '" & d & "'"
Data1.Refresh
Select Case userno
         Case 1
          'Data1.RecordSource = "SELECT * FROM TempA"
          Data1.RecordSource = "select * from Temp1 where Actcode = '" & d & "'"
         Case 2
          'Data1.RecordSource = "SELECT * FROM TempW"
          Data1.RecordSource = "select * from Temp2 where Actcode = '" & d & "'"
         Case 3
           'Data1.RecordSource = "SELECT * FROM TempK"
           Data1.RecordSource = "select * from Temp3 where Actcode = '" & d & "'"
         Case 4
           'Data1.RecordSource = "SELECT * FROM TempM"
           Data1.RecordSource = "select * from Temp4 where Actcode = '" & d & "'"
         Case 5
           'Data1.RecordSource = "SELECT * FROM Temp"
           Data1.RecordSource = "select * from Temp5 where Actcode = '" & d & "'"
         Case 6
           Data1.RecordSource = "select * from Temp6 where Actcode = '" & d & "'"
         Case 7
           Data1.RecordSource = "select * from Temp7 where Actcode = '" & d & "'"
         Case 8
           Data1.RecordSource = "select * from Temp8 where Actcode = '" & d & "'"
         Case 9
           Data1.RecordSource = "select * from Temp9 where Actcode = '" & d & "'"
         Case 10
           Data1.RecordSource = "select * from Temp10 where Actcode = '" & d & "'"
  End Select
        Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        M = MsgBox("Are you sure you want to delete the Record ???", vbYesNo)
        If M = 6 Then
            Data1.Recordset.Delete
        End If
    
        If M = 7 Then
          CmdDel.SetFocus
        End If
    End If

'Data1.RecordSource = "select * from Temp"
Select Case userno
         Case 1
          Data1.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data1.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data1.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data1.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data1.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data1.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data1.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data1.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data1.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data1.RecordSource = "SELECT * FROM Temp10"
End Select

Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        'Data2.RecordSource = "select sum(Amount) as CRV from Temp"
   Select Case userno
         Case 1
          'Data2.RecordSource = "SELECT * FROM TempA"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp1"
         Case 2
          'Data2.RecordSource = "SELECT * FROM TempW"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp2"
         Case 3
          'Data2.RecordSource = "SELECT * FROM TempK"
           Data2.RecordSource = "select sum(Amount) as CRV from Temp3"
         Case 4
          'Data2.RecordSource = "SELECT * FROM TempM"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp4"
         Case 5
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp5"
         Case 6
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp6"
         Case 7
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp7"
         Case 8
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp8"
         Case 9
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp9"
         Case 10
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as CRV from Temp10"
          
    End Select
        
        Data2.Refresh
            TxtCrTot.Text = Data2.Recordset!CRV
    Else
            TxtCrTot.Text = 0
    End If
        
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

    Data2.Refresh
    DBAct.Refresh

End Sub

Private Sub CmdEdit_Click()
    a = MsgBox("Are You Sure to Delete This Voucher", vbCritical + vbYesNoCancel, "Delete.!")
    
    If a = vbNo Then
        Exit Sub
    End If
    
    If a = vbCancel Then
        Exit Sub
    End If
    
    
Data1.RecordSource = "select * from Trans where Vnon = " & Val(TxtVno.Text) & " and vnoc ='" & "CPV" & "'" & " order by TRANSAMT"
Data1.Refresh

If Data1.Recordset.RecordCount > 0 Then

        Data1.Recordset.MoveFirst
    Do While Not Data1.Recordset.EOF
        Data1.Recordset.Delete
        Data1.Recordset.MoveNext
    Loop
    
End If
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

Data2.Refresh

If Data2.Recordset.RecordCount > 0 Then
    Do Until Data2.Recordset.EOF
        Data2.Recordset.Delete
        Data2.Recordset.MoveNext
    Loop
End If
    txtDAccode.Text = Data4.Recordset!cashac
    TxtDAcName.Text = Data4.Recordset!CashName
    TxtCrAmt.Text = ""
    TxtCAccode.Text = ""
    TxtCAcName.Text = ""
    TxtChqNo.Text = ""
    TxtDes.Text = ""
    TxtCrTot.Text = ""
    mtchqdt.Text = "  /  /    "
    'MtVDt.Text = Format(Now, "dd/MM/yyyy")
    
    Data1.RecordSource = " SELECT * FROM TRANS where Vnoc ='" & "CPV" & "'" 'JV' and month = " & monthno & "and year=" & yearno
    Data1.Refresh
        If Data1.Recordset.RecordCount = 0 Then
         '   TxtVno.Text = 1
        Else
            Data1.Recordset.MoveLast
          '  TxtVno.Text = Data1.Recordset!vnon + 1
        End If
            
            MtVDt.SetFocus

Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

    Data2.Refresh
    DBAct.Refresh
  cmdNew.SetFocus

End Sub

Private Sub CmdEnd_Click()
    TxtDes.SetFocus
End Sub

Private Sub CmdExit_Click()

'Data1.RecordSource = "SELECT * FROM Temp"
Select Case userno
         Case 1
          Data1.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data1.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data1.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data1.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data1.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data1.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data1.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data1.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data1.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data1.RecordSource = "SELECT * FROM Temp10"
End Select

Data1.Refresh

If Data1.Recordset.RecordCount > 0 Then
    Do Until Data1.Recordset.EOF
        Data1.Recordset.Delete
        Data1.Recordset.MoveNext
    Loop
End If
'    FrmTrans.Show
'    FrmTrans.cmdExit.SetFocus
    Unload Me
End Sub

Private Sub cmdNew_Click()

'Data2.RecordSource = "SELECT * FROM Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

Data2.Refresh

If Data2.Recordset.RecordCount > 0 Then
    Do Until Data2.Recordset.EOF
        Data2.Recordset.Delete
        Data2.Recordset.MoveNext
    Loop
End If
    
    TxtCAccode.Text = ""
    TxtCAcName.Text = ""
    TxtCrAmt.Text = ""
    txtDAccode.Text = ""
    TxtDAcName.Text = ""
    TxtChqNo.Text = ""
    TxtDes.Text = ""
    TxtCrTot.Text = ""
    mtchqdt.Text = "  /  /    "
    'MtVDt.Text = Format(Now, "dd/MM/yyyy")
    
    Data1.RecordSource = " SELECT * FROM TRANS where Vnoc <>'" & "JV" & "'" & " and vnoc <>'" & "SV" & "'" ' and month = " & monthno & "and year=" & yearno
    Data1.Refresh
        If Data1.Recordset.RecordCount = 0 Then
            TxtVno.Text = 1
        Else
            Data1.Recordset.MoveLast
            TxtVno.Text = Data1.Recordset!vnon + 1
        End If
            MtVDt.SetFocus

Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select
    
    Data2.Refresh
    DBAct.Refresh
    UserLBL.Caption = ""
    TimeLBL.Caption = ""
    TxtVno.SetFocus
End Sub

Private Sub cmdNext_Click()
    TxtCAccode.Text = ""
    TxtCAcName.Text = ""
    TxtCrAmt.Text = ""
    TxtCAccode.SetFocus
End Sub

Private Sub cmdsave_Click()

If txtDAccode.Text = "" Or TxtDAcName.Text = "" Then
    Beep
    MsgBox "Some fields are empty ! Record cannot be updated ..............", vbCritical
    txtDAccode.SetFocus
Else

If TxtChqNo.Text = "" Then TxtChqNo.Text = "-"
If TxtDes.Text = "" Then TxtDes.Text = "-"

Data1.RecordSource = "SELECT * FROM Trans where vnon = " & TxtVno.Text & " and vnoc ='" & "CPV" & "'" ' JV' and month = " & monthno & "and year=" & yearno
Data1.Refresh
    
'Data2.RecordSource = "SELECT * FROM Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

Data2.Refresh

If Data1.Recordset.RecordCount > 0 Then
    Do Until Data1.Recordset.EOF
        Data1.Recordset.Delete
        Data1.Recordset.MoveNext
    Loop
End If
    Do Until Data2.Recordset.EOF
        Data1.Recordset.AddNew
        Data1.Recordset!ACTCODE = Data2.Recordset!ACTCODE
        Data1.Recordset!ACTNAME = Data2.Recordset!ACTNAME
        Data1.Recordset!transamt = Data2.Recordset!Amount
        Data1.Recordset!Date = MtVDt.Text
        Data1.Recordset!vnon = TxtVno.Text
        Data1.Recordset!vnoc = "CPV"
       ' Data1.Recordset!chqno = TxtChqNo.Text
        Data1.Recordset!Month = Val(monthNumber.Caption)
        Data1.Recordset!Year = Val(YearList.Text)
        Data1.Recordset!USERNAME = USER
        Data1.Recordset!Password = userpsw
        Data1.Recordset!systemdate = Now
        
        If mtchqdt.Text <> "  /  /    " Then
        '    Data1.Recordset!chqdate = mtchqdt.Text
        End If
        
        Data1.Recordset!Des = TxtDes.Text
        Data1.Recordset.Update
        Data2.Recordset.MoveNext
    Loop
        Data1.Recordset.AddNew
        Data1.Recordset!ACTCODE = txtDAccode.Text
        Data1.Recordset!ACTNAME = TxtDAcName.Text
        Data1.Recordset!transamt = Val(TxtCrTot.Text) * -1
        Data1.Recordset!Date = MtVDt.Text
        Data1.Recordset!vnon = TxtVno.Text
        Data1.Recordset!vnoc = "CPV"
       ' Data1.Recordset!chqno = TxtChqNo.Text
        Data1.Recordset!Month = Val(monthNumber.Caption)
        Data1.Recordset!Year = Val(YearList.Text)
        Data1.Recordset!USERNAME = USER
        Data1.Recordset!Password = userpsw
        Data1.Recordset!systemdate = Now
        
        If mtchqdt.Text <> "  /  /    " Then
        '    Data1.Recordset!chqdate = mtchqdt.Text
        End If
        
        Data1.Recordset!Des = TxtDes.Text
        Data1.Recordset.Update
        MsgBox "Record has been Saved ............", vbInformation
        cmdNew.SetFocus
End If
End Sub

Private Sub cmdUpdate_Click()

If TxtCAccode.Text = "" Or TxtCAcName.Text = "" Or txtDAccode.Text = "" Or TxtDAcName.Text = "" Then
    Beep
    MsgBox "Some fields are empty ! Record cannot be updated ..............", vbCritical
    txtDAccode.SetFocus
Else

If TxtCrAmt.Text = "" Then TxtCrAmt.Text = "0"

'Data2.RecordSource = "select * from Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

Data2.Refresh

If Data2.Recordset.RecordCount < 8 Then
    Data2.Recordset.AddNew
    Data2.Recordset!ACTCODE = TxtCAccode.Text
    Data2.Recordset!ACTNAME = TxtCAcName.Text
    Data2.Recordset!Amount = TxtCrAmt.Text
    Data2.Recordset.Update
        cmdNext.SetFocus
    
'    Data2.RecordSource = "select sum(Amount) as cr from Temp"
   Select Case userno
         Case 1
          'Data2.RecordSource = "SELECT * FROM TempA"
          Data2.RecordSource = "select sum(Amount) as cr from Temp1"
         Case 2
          'Data2.RecordSource = "SELECT * FROM TempW"
          Data2.RecordSource = "select sum(Amount) as cr from Temp2"
         Case 3
          'Data2.RecordSource = "SELECT * FROM TempK"
           Data2.RecordSource = "select sum(Amount) as cr from Temp3"
         Case 4
          'Data2.RecordSource = "SELECT * FROM TempM"
          Data2.RecordSource = "select sum(Amount) as cr from Temp4"
         Case 5
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp5"
         Case 6
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp6"
         Case 7
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp7"
         Case 8
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp8"
         Case 9
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp9"
          
    End Select

    Data2.Refresh
        TxtCrTot.Text = Data2.Recordset!Cr
        
'    Data2.RecordSource = "select * from Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select
    
       Data2.Refresh
        DBAct.Refresh
Else
    MsgBox "Only eight records are valid for one voucher ........... ", vbInformation
End If
End If
End Sub

Private Sub Command1_Click()
ChartofAccounts.Show vbModal
End Sub

Private Sub DBAct_AfterColUpdate(ByVal ColIndex As Integer)
'Data2.RecordSource = "select sum(Amount) as cr from Temp"
   Select Case userno
         Case 1
          'Data2.RecordSource = "SELECT * FROM TempA"
          Data2.RecordSource = "select sum(Amount) as cr from Temp1"
         Case 2
          'Data2.RecordSource = "SELECT * FROM TempW"
          Data2.RecordSource = "select sum(Amount) as cr from Temp2"
         Case 3
          'Data2.RecordSource = "SELECT * FROM TempK"
           Data2.RecordSource = "select sum(Amount) as cr from Temp3"
         Case 4
          'Data2.RecordSource = "SELECT * FROM TempM"
          Data2.RecordSource = "select sum(Amount) as cr from Temp4"
         Case 5
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp5"
         Case 6
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp6"
         Case 7
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp7"
         Case 8
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp8"
         Case 9
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp9"
         Case 10
          'Data2.RecordSource = "SELECT * FROM Temp"
          Data2.RecordSource = "select sum(Amount) as cr from Temp10"
    End Select

Data2.Refresh
    TxtCrTot.Text = Data2.Recordset!Cr
    
'Data2.RecordSource = "select * from Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

Data2.Refresh
    DBAct.Refresh
End Sub


Private Sub Form_Load()
'Me.Top = (Screen.Height - Me.Height) / 2
'Me.Left = (Screen.Width - Me.Width) / 2
UserLBL.Caption = ""
TimeLBL.Caption = ""
Me.Top = (Screen.Height - Me.Height) / 2
    Me.Left = (Screen.Width - Me.Width) / 2

    FrmCashPayVou.Caption = "Payment Vouchers ..... " & " (" & CompanyTitle & ")"

Data1.DatabaseName = App.Path & "\TeleLnk.mdb"
Data2.DatabaseName = App.Path & "\TeleLnk.mdb"
Data3.DatabaseName = App.Path & "\TeleLnk.mdb"
Data4.DatabaseName = App.Path & "\TeleLnk.mdb"

Data4.RecordSource = "select * from cashname"
Data4.Refresh
Data4.Recordset.MoveFirst

Data3.RecordSource = "select * from serial order by month"
Data3.Refresh

Data3.Recordset.MoveFirst
Do Until Data3.Recordset.EOF
   months.AddItem (Data3.Recordset!cMonth)
   Data3.Recordset.MoveNext
Loop
        months.ListIndex = 0
        YearList.ListIndex = 0
        MtVDt.Text = Format(Now, "dd/MM/yyyy")
        monthno = Month(MtVDt.Text)
        YearList = Year(Format(MtVDt.Text, "mm/dd/yyyy"))
        Data3.Recordset.FindFirst "month =" & monthno
        months.Text = Data3.Recordset!cMonth
        
        UserLBL.Caption = ""
        TimeLBL.Caption = ""
End Sub

Private Sub List1_KeyPress(KeyAscii As Integer)
If KeyAscii = (27) Then
    FrameLst.Visible = False
    txtDAccode.SetFocus
End If

If KeyAscii = (13) Then
Data1.RecordSource = "select ActCode, ActName from Acfile where Actname = '" & List1.Text & "'"
Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        txtDAccode.Text = Data1.Recordset!ACTCODE
        TxtDAcName.Text = Data1.Recordset!ACTNAME
        TxtCAccode.SetFocus
        FrameLst.Visible = False
    End If
End If
End Sub

Private Sub List2_KeyPress(KeyAscii As Integer)
If KeyAscii = (27) Then
    Framelst1.Visible = False
    TxtCAccode.SetFocus
End If

If KeyAscii = (13) Then
Data1.RecordSource = "select ActCode, ActName from Acfile where Actname = '" & List2.Text & "'"
Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        TxtCAccode.Text = Data1.Recordset!ACTCODE
        TxtCAcName.Text = Data1.Recordset!ACTNAME
        TxtCrAmt.SetFocus
        Framelst1.Visible = False
    End If
End If
End Sub

Private Sub months_Click()
Data3.Recordset.FindFirst "cmonth ='" & months.Text & "'"
monthNumber.Caption = Data3.Recordset!Month
End Sub

Private Sub months_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub months_LostFocus()
Call Calcu
monthno = Month(MtVDt.Text)
    Data1.RecordSource = "SELECT max(vnon) as maximum FROM TRANS where vnoc <>'" & "JV" & "'" ' JV' and month = " & monthno & "and year=" & yearno
    Data1.Refresh
    If Data1.Recordset.RecordCount = 0 Or IsNull(Data1.Recordset!maximum) = True Then
        TxtVno.Text = 1
    Else
        TxtVno.Text = Data1.Recordset!maximum + 1
    End If
    'TxtVno.SelStart = 0
    'TxtVno.SelLength = Len(TxtVno.Text)
End Sub

Private Sub mtchqdt_GotFocus()
    mtchqdt.Text = MtVDt.Text
End Sub

Private Sub MtVDt_GotFocus()
    MtVDt.SelStart = 0
    MtVDt.SelLength = 2
End Sub

Private Sub MtVDt_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub MtVDt_LostFocus()
If MtVDt.Text <> "  /  /    " Then
    If Left(MtVDt.Text, 2) > 31 Or Mid(MtVDt.Text, 4, 2) > 12 Then
        MsgBox "Invalid Date ..........", vbInformation
        MtVDt.Text = Format(Now, "dd/MM/yyyy")
        MtVDt.SetFocus
    End If
End If
    xx = Month(MtVDt.Text)
    yy = Year(MtVDt.Text)
    If yy <> Val(YearList.Text) Or xx <> Val(monthNumber.Caption) Then
    '   MsgBox "Invalid Date ..........", vbInformation
    '   MtVDt.SetFocus
    End If


mtchqdt.Text = MtVDt.Text
End Sub

Private Sub mtchqdt_LostFocus()
If mtchqdt.Text <> "  /  /    " Then
    If Left(mtchqdt.Text, 2) > 31 Or Mid(mtchqdt.Text, 4, 2) > 12 Then
        MsgBox "Invalid Date ..........", vbInformation
        mtchqdt.Text = Format(Now, "dd/MM/yyyy")
        mtchqdt.SetFocus
    End If
End If
End Sub

Private Sub Text1_KeyPress(KeyAscii As Integer)
If KeyAscii = (27) Then
    txtDAccode.SetFocus
    FrameLst.Visible = False
End If

If KeyAscii = (13) Then
    txt = Text1.Text & "*"
    Data1.RecordSource = "select ActCode, ActName from AcFile where ActName like '" & txt & "' order by ActName"
    Data1.Refresh
    
    If Data1.Recordset.RecordCount > 0 Then
        List1.Clear
        Do While Not Data1.Recordset.EOF
            List1.AddItem Data1.Recordset!ACTNAME
            Data1.Recordset.MoveNext
        Loop
            List1.SetFocus
            List1.Selected(0) = True
    Else
        List1.Clear
        Text1.SetFocus
    End If
End If
End Sub

Private Sub Text2_KeyPress(KeyAscii As Integer)
If KeyAscii = (27) Then
    TxtCAccode.SetFocus
    Framelst1.Visible = False
End If
    
If KeyAscii = (13) Then
    Txt1 = Text2.Text & "*"
    Data1.RecordSource = "select ActCode, ActName from AcFile where ActName like '" & Txt1 & "' order by ActName"
    Data1.Refresh
    
    If Data1.Recordset.RecordCount > 0 Then
        List2.Clear
        axn = 0
        Do While Not Data1.Recordset.EOF
           'If Left(Data1.Recordset!actcode, 4) = "1.8." Then
                      List2.AddItem Data1.Recordset!ACTNAME
                      axn = 1
           'End If
            Data1.Recordset.MoveNext
        Loop
            List2.SetFocus
            If axn = 1 Then
            List2.Selected(0) = True
            Else
             MsgBox "THERE ISN'T MATCH CLIENT NAME", vbCritical, "Info..."
             Text2.Text = ""
             Text2.SetFocus
            End If
    Else
        List2.Clear
        Text2.SetFocus
    End If
End If
End Sub

Private Sub txtCAcCode_GotFocus()
    
    Me.Caption = "Press F4 to view the list of Account Code .............."
    
Data1.RecordSource = "select * from Acfile where Actcode = '" & txtDAccode.Text & "'"
Data1.Refresh
    If Data1.Recordset.RecordCount = 0 Then
        MsgBox "Invalid Account Code ............", vbCritical
        TxtDAcName.Text = ""
        txtDAccode.SetFocus
    Else

txt = txtDAccode.Text & "." & "*"
Data1.RecordSource = "select * from Acfile where Actcode like '" & txt & "'"
Data1.Refresh
    
    If Data1.Recordset.RecordCount > 0 Then
        Data1.Recordset.MoveLast
        Data1.Recordset.MoveFirst
        MsgBox "You can't enter an amount for control account ..........", vbCritical
        TxtDAcName.Text = ""
        txtDAccode.SetFocus
        Exit Sub
        Exit Sub
    End If
    End If
End Sub

Private Sub txtDAcCode_GotFocus()
    Me.Caption = "Press F4 to view the list of Account Code .............."
End Sub

Private Sub TxtCrAmt_GotFocus()
'TxtDes.Text = "JV#" + TxtVno + " " + TxtCAcName
If TxtCAccode.Text <> "" Then
Data1.RecordSource = "select * from Acfile where Actcode = '" & TxtCAccode.Text & "'"
Data1.Refresh
    If Data1.Recordset.RecordCount = 0 Then
        MsgBox "Invalid Account Code ............", vbCritical
        TxtCAcName.Text = ""
        TxtCAccode.SetFocus
    Else

txt = TxtCAccode.Text & "." & "*"
Data1.RecordSource = "select * from Acfile where Actcode like '" & txt & "'"
Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        Data1.Recordset.MoveLast
        Data1.Recordset.MoveFirst
        MsgBox "You can't enter an amount for control account ..........", vbCritical
        TxtCAcName.Text = ""
        TxtCAccode.SetFocus
        Exit Sub
    End If
    End If
End If
End Sub

Private Sub txtDAcCode_KeyDown(KeyCode As Integer, Shift As Integer)
    
    If KeyCode = vbKeyF4 Then
        txtDAccode.Text = ""
        FrameLst.Visible = True
        Text1.Text = ""
        Text1.SetFocus
        
        Data1.RecordSource = "SELECT * FROM Acfile order by Actname"
        Data1.Refresh
            List1.Clear
        Do While Not Data1.Recordset.EOF
            List1.AddItem Data1.Recordset!ACTNAME
            Data1.Recordset.MoveNext
        Loop
        Text1.SetFocus
    End If
End Sub

Private Sub txtCAcCode_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub txtCAcName_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub txtCAcCode_KeyDown(KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyF4 Then
        TxtCAccode.Text = ""
        Framelst1.Visible = True
        Text2.Text = ""
        Data1.RecordSource = "SELECT * FROM Acfile order by Actname"
        Data1.Refresh
            List2.Clear
        Do While Not Data1.Recordset.EOF
            'If Left(Data1.Recordset!actcode, 4) = "1.8." Then
             List2.AddItem Data1.Recordset!ACTNAME
            'End If
            Data1.Recordset.MoveNext
        Loop
            Text2.SetFocus
    End If
End Sub

Private Sub txtDAcCode_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub txtDAcCode_LostFocus()
Me.Caption = "Receipt Vouchers ..........."
Data1.RecordSource = "select ActCode, ActName from Acfile where ActCode = '" & txtDAccode.Text & "'"
Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        TxtDAcName.Text = Data1.Recordset!ACTNAME
        TxtCAccode.SetFocus
    End If
End Sub

Private Sub txtCAcCode_LostFocus()
Me.Caption = "Receipt Vouchers ..........."
Data1.RecordSource = "select ActCode, ActName from Acfile where ActCode = '" & TxtCAccode.Text & "'"
Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        TxtCAcName.Text = Data1.Recordset!ACTNAME
        TxtCrAmt.SetFocus
    End If
End Sub

Private Sub txtDAcName_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub TxtCrAmt_KeyPress(KeyAscii As Integer)
If KeyAscii = (13) Then
    SendKeys "{Tab}"
End If
  
If (KeyAscii < 47 Or KeyAscii > 57) And (KeyAscii <> 8 And KeyAscii <> 46 And KeyAscii <> 45) Then
    KeyAscii = 0
    TxtCrAmt.SetFocus
End If
End Sub

Private Sub TxtcrTot_KeyPress(KeyAscii As Integer)
If KeyAscii > 0 Or KeyAscii < 1000 Then
    KeyAscii = 0
    TxtCrTot.SetFocus
End If
End Sub

Private Sub TxtDes_Change()
   ' TxtDes.Text = Format(TxtDes.Text, ">")
   ' SendKeys "{End}"
End Sub

Private Sub TxtDes_GotFocus()
TxtDes.SelLength = 0
TxtDes.SelLength = Len(TxtDes.Text)
End Sub

Private Sub TxtVno_GotFocus()
        UserLBL.Caption = ""
        TimeLBL.Caption = ""
    monthno = Month(MtVDt.Text)
    Data1.RecordSource = "SELECT max(vnon) as maximum FROM TRANS where vnoc <>'" & "JV" & "'" & " and vnoc <>'" & "SV" & "'" 'JV' and month = " & monthno & "and year=" & yearno
    Data1.Refresh
    If Data1.Recordset.RecordCount = 0 Or IsNull(Data1.Recordset!maximum) = True Then
        TxtVno.Text = 1
    Else
        TxtVno.Text = Data1.Recordset!maximum + 1
    End If
    TxtVno.SelStart = 0
    TxtVno.SelLength = Len(TxtVno.Text)
End Sub

Private Sub TxtVno_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub Txtchqno_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub mtchqdt_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub Txtdes_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub TxtVno_LostFocus()

Data1.RecordSource = "select * from Trans where Vnon = " & TxtVno.Text & " and vnoc ='" & "CRV" & "'"  '  'JV' and month = " & monthno & "and year=" & yearno
Data1.Refresh
If Data1.Recordset.RecordCount > 0 Then
   MsgBox "This Voucher Number is Recieved (Debit) Voucher ....", vbCritical, "Voucher Type Info ...."
   TxtVno.SetFocus
   Exit Sub
End If


Data1.RecordSource = "select * from Trans where Vnon = " & TxtVno.Text & " and vnoc ='" & "CPV" & "'" 'JV' and month = " & monthno & "and year=" & yearno
Data1.Refresh

If Data1.Recordset.RecordCount = 0 Then

'Data2.RecordSource = "SELECT * FROM Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

Data2.Refresh

If Data2.Recordset.RecordCount > 0 Then
    Do Until Data2.Recordset.EOF
        Data2.Recordset.Delete
        Data2.Recordset.MoveNext
    Loop
End If
    txtDAccode.Text = Data4.Recordset!cashac
    TxtDAcName.Text = Data4.Recordset!CashName
    TxtCrAmt.Text = ""
    TxtCAccode.Text = ""
    TxtCAcName.Text = ""
    TxtChqNo.Text = ""
    TxtDes.Text = ""
    TxtCrTot.Text = ""
    mtchqdt.Text = "  /  /    "
    'MtVDt.Text = Format(Now, "dd/MM/yyyy")
    
    Data1.RecordSource = " SELECT * FROM TRANS where Vnoc ='" & "CPV" & "'" 'JV' and month = " & monthno & "and year=" & yearno
    Data1.Refresh
        If Data1.Recordset.RecordCount = 0 Then
         '   TxtVno.Text = 1
        Else
            Data1.Recordset.MoveLast
          '  TxtVno.Text = Data1.Recordset!vnon + 1
        End If
            
            MtVDt.SetFocus

Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

    Data2.Refresh
    DBAct.Refresh

Else

'Data2.RecordSource = "SELECT * FROM Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

Data2.Refresh

If Data2.Recordset.RecordCount > 0 Then
    Do Until Data2.Recordset.EOF
        Data2.Recordset.Delete
        Data2.Recordset.MoveNext
    Loop
End If

Data1.RecordSource = "select * from Trans where Vnon = " & TxtVno.Text & " and TransAmt > 0 and vnoc ='" & "CPV" & "'" 'JV' and month = " & monthno & "and year=" & yearno
Data1.Refresh
    
    Do Until Data1.Recordset.EOF
        Data2.Recordset.AddNew
        Data2.Recordset!ACTCODE = Data1.Recordset!ACTCODE
        Data2.Recordset!ACTNAME = Data1.Recordset!ACTNAME
        Data2.Recordset!Amount = Data1.Recordset!transamt
        Data2.Recordset.Update
        Data1.Recordset.MoveNext
    Loop
        
        
'    Data2.RecordSource = "SELECT * FROM Temp"
Select Case userno
         Case 1
          Data2.RecordSource = "SELECT * FROM Temp1"
         Case 2
          Data2.RecordSource = "SELECT * FROM Temp2"
         Case 3
          Data2.RecordSource = "SELECT * FROM Temp3"
         Case 4
          Data2.RecordSource = "SELECT * FROM Temp4"
         Case 5
          Data2.RecordSource = "SELECT * FROM Temp5"
         Case 6
          Data2.RecordSource = "SELECT * FROM Temp6"
         Case 7
          Data2.RecordSource = "SELECT * FROM Temp7"
         Case 8
          Data2.RecordSource = "SELECT * FROM Temp8"
         Case 9
          Data2.RecordSource = "SELECT * FROM Temp9"
         Case 10
          Data2.RecordSource = "SELECT * FROM Temp10"
End Select

    Data2.Refresh
        DBAct.Refresh
        
Data1.RecordSource = "select * from Trans where Vnon = " & TxtVno.Text & " and vnoc = 'CPV' and Transamt < 0" ' & "and month = " & monthno & "and year=" & yearno
Data1.Refresh
    If Data1.Recordset.RecordCount > 0 Then
        txtDAccode.Text = Data1.Recordset!ACTCODE
        TxtDAcName.Text = Data1.Recordset!ACTNAME
        TxtCrTot.Text = Data1.Recordset!transamt * -1
       ' TxtChqNo.Text = Data1.Recordset!chqno
       ' mtchqdt.Text = Data1.Recordset!CHQDATE
        MtVDt.Text = Data1.Recordset!Date
        UserLBL.Caption = Data1.Recordset!USERNAME
        TimeLBL.Caption = Data1.Recordset!systemdate
        
        If Data1.Recordset!chqdate <> "" Then
            mtchqdt.Text = Data1.Recordset!chqdate
           Else
            mtchqdt.Text = "  /  /    "
        End If
        
        TxtDes.Text = Data1.Recordset!Des
        
    End If
End If
End Sub

Private Sub YearList_KeyPress(KeyAscii As Integer)
    If KeyAscii = (13) Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub YearList_LostFocus()
Call Calcu
monthno = Month(MtVDt.Text)
    Data1.RecordSource = "SELECT max(vnon) as maximum FROM TRANS where vnoc <>'" & "JV" & "'" 'JV' and month = " & monthno & "and year=" & yearno
    Data1.Refresh
    If Data1.Recordset.RecordCount = 0 Or IsNull(Data1.Recordset!maximum) = True Then
        TxtVno.Text = 1
    Else
        TxtVno.Text = Data1.Recordset!maximum + 1
    End If
    'TxtVno.SelStart = 0
    'TxtVno.SelLength = Len(TxtVno.Text)
End Sub
